# Определение наличия товаров на полке в интервалах без продаж · Направление 2
## Описание проекта
Система GoodsForecast.OSA* анализирует историю продаж в сети магазинов и определяет товары с наибольшей вероятностью отсутствия на полке.
Сотрудники магазинов по каждой позиции проверяют наличие товара и корректность ценника, при необходимости выставляя продукцию со склада и/или корректируя ценник.
Таким образом, мы стремимся обеспечить своевременное обнаружение отсутствия товаров на полке, чтобы покупатели не упустили возможность совершить покупку, а сеть повысила товарооборот.
## Инструменты
<code>Python, Pandas, Matplotlib, Scikit-learn, Catboost, Lightgbm</code>
## Задача:   
Нам необходимо решить задачу бинарной классификации – определение наличия товаров на полке в интервалах без продаж с оценкой производительности по метрике AUC-ROC.
## План работы:

 1. Загрузка и изучение данных.       
 2. Предобработка данных
   + проверим дубликаты
   + разделим трейн по условию задачи
   + удаление констант и пустых столбцов
   + изменение типов данных
   + заполним пропуски
   + удаление дублирующих столбцов
 3. Обучение моделей
   + Random Forest
   + Cat Boost
 4. Создание новых фичей
 5. feature_selection
 6. Обучение финальной модели
 7. Предсказание на тесте

## Вывод:   
По предоставленным заказчиком данным были изучены данные торговой сети, содержащие временные метки по магазинам и товарным позициям, в момент которых выявлялись наличия пустых полок, вероятность данного события, вычисленная заказчиком, а также признаки.<br>
Были выявлены и устранены множественные пропуски с помощью устранение неинформативных признаков и заполнения медианным значением.    
При выборе столбцов для обучения были использованы: select_features CatBoost, BorutaPy, arfsgroot, SequentialFeatureSelector, RFECV, ExhaustiveFeatureSelector, SelectFromModel, shap. Лучшим результатом оказался метод select_features от CatBoost.       
В качестве модели машинного обучения использовались модели RandomForest и CatBoost с ручным подбором гиперпараметров. Построена матрица ошибок, для контроля выявления именно отсутвия товара на полке, а не наличия, а также контроля ошибок модели.<br>
Метрика AUC-ROC данной модели на валидационной выборке составила 0.860763597376046
